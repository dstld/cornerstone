---
category:
    shop_by_price: true
    products:
        limit: {{theme_settings.categorypage_products_per_page}}
---
{{inject "categoryProductsPerPage" theme_settings.categorypage_products_per_page}}
{{inject "categoryList" categories}}
{{inject "currentCategory" category}}

{{#partial "head"}}
    {{#if pagination.category.previous}}
        <link rel="prev" href="{{pagination.category.previous}}">
    {{/if}}
    {{#if pagination.category.next}}
        <link rel="next" href="{{pagination.category.next}}">
    {{/if}}
{{/partial}}

{{#partial "page"}}
    <div class="category main-container">
        {{> components/common/breadcrumbs breadcrumbs=breadcrumbs}}

        <div class="page">
            {{#if category.faceted_search_enabled}}
                <aside class="page-sidebar" id="faceted-search-container">
                    {{> components/category/sidebar}}
                </aside>
            {{else if category.shop_by_price}}
                {{#if theme_settings.shop_by_price_visibility}}
                    <aside class="page-sidebar" id="faceted-search-container">
                        {{> components/category/sidebar}}
                    </aside>
                {{/if}}
            {{/if}}

            <main class="page-content" id="product-listing-container">
                {{#if category.image}}
                    <img class="lazyload category-image" data-sizes="auto" src="{{cdn 'img/loading.svg'}}" data-src="{{getImage category.image 'zoom_size'}}">
                {{/if}}
                <h1 class="page-heading">
                    {{#if (length (split category.name "_SubCategory")) '===' 2}}
                        {{#each (split category.name "_SubCategory") }}
                            {{#if @first }}
                                {{this}}
                            {{/if}}
                        {{/each}}
                    {{ else }}
                        {{category.name}}
                    {{/if}}
                </h1>
                <div style="padding-top: 20px;">
                    {{{category.description}}}
                </div>
                {{#each category.subcategories}}
                    {{#unless (length (split name "_SubCategory")) '===' 2}}
                        <div class="subcategory-list subcategory-{{id}} hidden">
                            <h3 class="title">/&nbsp;{{name}}</h3>
                            {{#if description }}
                                <div class="description">{{{description}}}</div>
                            {{/if}}
                            {{#if products}}
                                {{> components/category/product-listing}}
                            {{/if}}
                        </div>
                    {{/unless}}
                {{/each}}
            </main>
        </div>
    </div>
{{/partial}}
{{> layout/base}}
